[back](../../20251015定期月總結.md)

+  高斯平滑 (Gaussian Smoothing) 
+ LOESS / LOWESS (Locally Weighted Scatterplot Smoothing)
+ Savitzky–Golay 濾波器
+ 非局部均值 (Non-local Means)

| 方法                            | 原理概要                   | 主要控制參數               | 優點               | 缺點            | 適用情境           |
|---------------------------------|------------------------|----------------------|------------------|---------------|----------------|
| 高斯平滑                        | 將資料與高斯核卷積，依距離給權重       | σ（標準差，控制平滑程度）        | 實現簡單、平滑自然、對噪聲抑制好 | 會模糊邊界與細節、峰值降低 | 一般訊號或影像去噪、初步平滑 |
| LOESS / LOWESS                 | 在每個點附近用加權回歸（常為線性或二次）擬合 | span（局部範圍比例）         | 能處理非線性趨勢、靈活      | 計算量大、不適合高維資料  | 散點資料擬合、非線性曲線平滑 |
| Savitzky–Golay 濾波器           | 在滑動視窗內用多項式擬合後取中點值      | 視窗長度與多項式階數           | 可平滑同時保留峰值、斜率、曲率  | 對雜訊敏感、需等距資料   | 頻譜分析、化學光譜、信號處理 |
| 非局部均值                      | 根據整個影像（或訊號）中相似區塊給權重    | 檢索範圍、相似度權重（通常由 h 控制） | 能保留結構與紋理特徵、去噪效果佳 | 計算昂貴、需調參      | 影像去噪、高品質去噪應用   |

- 控制參數方向
    - 高斯平滑：σ 越大 → 越模糊。
    - LOESS：span 越大 → 越平滑（但可能過度平滑）。
    - Savitzky-Golay：視窗越大、階數越高 → 趨勢保留但噪聲平滑能力下降。
    - 非局部均值：相似度權重越嚴 → 結構保留越強但可能有噪點。
        
- 保留細節能力：  
    Savitzky-Golay ≈ 非局部均值 ＞ LOESS ＞ 高斯。
    
- 計算複雜度：  
    高斯 < Savitzky-Golay < LOESS < 非局部均值。


# 非局部平均

對於時間序列中每一個點，該方法：

1. 取出一個 中心 patch（例如：3點寬的區塊）
2. 在一個 搜尋視窗內，比對所有相鄰 patch 與中心 patch 的差異
3. 根據 patch 相似度（通常用高斯權重）對這些點做加權平均，得出新的值

目的：平滑雜訊，同時保留局部的結構（例如突變點、邊界）

### h：強度控制參數

- 控制「patch 差異」對權重的影響
- 小 `h` → 只有非常相似的 patch 才參與平均 → 保邊強
- 大 `h` → 許多 patch 都參與 → 更平滑但可能模糊邊界

常根據 `patch 差異的標準差` 設定 `h ≈ 0.8~1.2 × std`

### patch_size：局部結構的感知長度

- 越大，NLM 感知的「區塊變化」越完整 → 能過濾更多小雜訊
- 越小，越容易保留細節，但也容易保留雜訊

推薦：水位、氣候資料這類週期性資料用 `2~3` 效果不錯

### search_window：非局部搜尋範圍

- 控制會比較多少「相似 patch」
- 太小會錯過可能相似的結構（尤其週期性資料）
- 太大會拖慢速度

小資料：`5~10`；大資料（>1000）建議 `10~20`

