[back](../../20251015定期月總結.md)

# 基本組合

時間窗口 \[+分布加權\] \[+多項式回歸\]

|是否加權|是否多項式擬合|方法名稱|說明|
|---|---|---|---|
|否|否|移動平均 (Moving Average)|對固定窗口內的點取平均值。簡單、穩定，但可能造成邊界延遲。|
|✅|否|核回歸 (Kernel Regression) |使用核函數（如 Gaussian）對窗口內的點加權，使靠近中心的點權重更大。|
|否|✅|Savitzky–Golay 濾波器|在滑動窗口中擬合一個低階多項式（通常二次或三次），取中心點的擬合值。能平滑又保留曲線形狀（不會模糊尖峰）。|
|✅|✅|LOESS / LOWESS（局部加權回歸）|在每個查詢點附近，用核函數加權資料點，再做局部多項式回歸。非常靈活，適合非線性資料。|

+ 核回歸也可稱加權移動平均 (Weighted Moving Average)
+ 一維資料且只用高斯核作為權重函數時，且不做局部多項式擬合（即是局部常數估計），核回歸的預測值和高斯平滑


# 非局部平均

對於時間序列中每一個點，該方法：

1. 取出一個 中心 patch（例如：3點寬的區塊）
2. 在一個 搜尋視窗內，比對所有相鄰 patch 與中心 patch 的差異
3. 根據 patch 相似度（通常用高斯權重）對這些點做加權平均，得出新的值

目的：平滑雜訊，同時保留局部的結構（例如突變點、邊界）

### h：強度控制參數

- 控制「patch 差異」對權重的影響
- 小 `h` → 只有非常相似的 patch 才參與平均 → 保邊強
- 大 `h` → 許多 patch 都參與 → 更平滑但可能模糊邊界

常根據 `patch 差異的標準差` 設定 `h ≈ 0.8~1.2 × std`

### patch_size：局部結構的感知長度

- 越大，NLM 感知的「區塊變化」越完整 → 能過濾更多小雜訊
- 越小，越容易保留細節，但也容易保留雜訊

推薦：水位、氣候資料這類週期性資料用 `2~3` 效果不錯

### search_window：非局部搜尋範圍

- 控制會比較多少「相似 patch」
- 太小會錯過可能相似的結構（尤其週期性資料）
- 太大會拖慢速度

小資料：`5~10`；大資料（>1000）建議 `10~20`

